@model ICTPRG535_556.Models.SessionCartDTO

<main>
    <h2 style="text-align:center">Our Products</h2>
    <div style="display: flex; justify-content: space-between; align-items: center;">
        @{
            var loggedInUserId = ViewBag.LoggedInUserId as int?;
        }
    </div>

    <h2 style="text-align:center;">
        <br /><br />
        <a href="/Cart/CreateNewList?id=@loggedInUserId" class="button">
            <button class="btn btn-primary" style="margin: 10px 20px;">New List</button>
        </a>
        <a href="/Cart/Select" class="button">
            <button class="btn btn-primary" style="margin: 10px 20px;">Select / Delete List</button>
        </a>
        <a href="/" class="button">
            <button class="btn btn-primary" style="margin: 10px 20px;">Add Item</button>
        </a>
    </h2>
    <p style="font-weight:bold">Cart Name: @ViewData["ListName"]</p>
    <p style="font-weight:bold">User Email: @ViewBag.Email</p>

    <form id="searchForm" method="get" action="@Url.Action("Search", "Home")" style="margin-right: 50px;">
        <input type="text" name="search" id="searchInput" placeholder="Search..." />
        <button type="submit">Search</button>
        <button type="button" id="clearButton">Clear</button>
    </form>

    <div class="card-container" id="searchResults">
        @foreach (var item in Model.ProduceItems)
        {
            <div class="card">
                <h3>@item.Name</h3>
                <p>Unit: @item.Unit</p>
                <p>Price: $@item.Price</p>
                <form method="post" asp-action="AddToCart">
                    <input type="hidden" name="itemId" value="@item.ItemID" />
                    <button type="submit" class="btn btn-primary">Add to Cart</button>
                </form>
            </div>
        }
    </div>
</main>

<br />
<br />
<br />

<footer>&copy; 2024 Shopping List Site</footer>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $('#searchForm').submit(function (event) {
            event.preventDefault();
            $.get($(this).attr('action'), $(this).serialize(), function (data) {
                $('#searchResults').html(data);
            });
        });

        $('#clearButton').click(function () {
            $('#searchInput').val('');
            $.get('@Url.Action("Index", "Home")', function (data) {
                var newCards = $(data).find('#searchResults').html();
                $('#searchResults').html(newCards);
            });
        });
    });

</script>

